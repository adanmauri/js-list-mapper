<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf8" >
		<script src="Objetos2.js" ></script>
		<link rel="stylesheet" type="text/css" href="css/style.css" />
		<script>

		async function workSpace () {		
			var selector = new ElementSelector({
				title: "//ol[@id='searchResults']/li//h2/a/span/text()",
				price: "//ol[@id='searchResults']/li//span[@class='price-fraction']/text()",
				url:   "//ol[@id='searchResults']/li//a[@class='item__info-title']/@href",
				img:   "//ol[@id='searchResults']/li//div[@class='images-viewer']//img"
			});
				
			var collection = new ElementCollection(selector);
			var paginator = new ElementPaginator("//div[@class='pagination__container']//li[@class='pagination__next']/a/@href");
			var es = new ElementSearch("pokemon", "http://www.mercadolibre.com.ar", {elementSelector: selector, elementPaginator: paginator}, "//input[@class='nav-search-input']");
			var ec = await es.search();
			var count = 0;
			var e;
			
			do {
				while (e = ec.next()) {
					count++;
					img = e["img"]["src"]?e["img"]["src"]:e["img"].title;

					document.getElementById("mercadolibre").innerHTML += "<a target=\"_blank\" href=\"" + e.url + "\">\
						<div class=\"product-box\">\
							<div class=\"product-image\" style=\"background-image:url('" + img + "');\"></div>\
							<div class=\"product-title\">" + e.title + "</div>\
							<div class=\"product-price\">$ " + e.price + "</div>\
						</div>\
					</a>";
				}
				
			} while ((ec = await ec.nextPage()) && (count < 1000));
			console.log(count);
		}
		workSpace();
		</script>
	</head>
	<body>
		<div id="mercadolibre"></div>
	</body>
</html>
